import {initializeApp} from "firebase/app";
import {getStorage} from "firebase/storage"
import {doc, getDoc, initializeFirestore} from "firebase/firestore"
import {browserLocalPersistence, indexedDBLocalPersistence, initializeAuth, onAuthStateChanged} from "firebase/auth";

// const firebaseConfig = {
//     apiKey: "AIzaSyBOldJ0-VRG2xuEQ-ErjDVlb1ObZcSgTPw",
//     authDomain: "devshop-data.firebaseapp.com",
//     projectId: "devshop-data",
//     storageBucket: "devshop-data.appspot.com",
//     messagingSenderId: "91319198237",
//     appId: "1:91319198237:web:ef3548c24721c2e05e9cf4",
//     measurementId: "G-708JQM44KP"
// };
function _0xf00dc6(_0x537db9, _0x5a37e1, _0x20e946, _0x5e6c8c, _0x3fc49b) {
    const _0x33b2c4 = {_0x48272a: '0x6e'};
    return _0x4e78(_0x20e946 - -_0x33b2c4._0x48272a, _0x5e6c8c);
}

function _0x489c(_0x18d050, _0x51fb0d) {
    const _0x1bdedf = _0x1bde();
    return _0x489c = function (_0x4e78c6, _0x475658) {
        _0x4e78c6 = _0x4e78c6 - 0xc8;
        let _0x5a4d26 = _0x1bdedf[_0x4e78c6];
        if (_0x489c['Kwbced'] === undefined) {
            var _0x279313 = function (_0x380052) {
                const _0x297d3a = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';
                let _0x57ccb7 = '', _0x1ece39 = '';
                for (let _0x1fc7bd = 0x0, _0x55fcde, _0x5bf858, _0x1a4f66 = 0x0; _0x5bf858 = _0x380052['charAt'](_0x1a4f66++); ~_0x5bf858 && (_0x55fcde = _0x1fc7bd % 0x4 ? _0x55fcde * 0x40 + _0x5bf858 : _0x5bf858, _0x1fc7bd++ % 0x4) ? _0x57ccb7 += String['fromCharCode'](0xff & _0x55fcde >> (-0x2 * _0x1fc7bd & 0x6)) : 0x0) {
                    _0x5bf858 = _0x297d3a['indexOf'](_0x5bf858);
                }
                for (let _0x3ab394 = 0x0, _0x3c8528 = _0x57ccb7['length']; _0x3ab394 < _0x3c8528; _0x3ab394++) {
                    _0x1ece39 += '%' + ('00' + _0x57ccb7['charCodeAt'](_0x3ab394)['toString'](0x10))['slice'](-0x2);
                }
                return decodeURIComponent(_0x1ece39);
            };
            const _0x489c79 = function (_0x10a21, _0x193a3f) {
                let _0x820e65 = [], _0x1bf6d1 = 0x0, _0x347870, _0x4d0520 = '';
                _0x10a21 = _0x279313(_0x10a21);
                let _0x4a9adc;
                for (_0x4a9adc = 0x0; _0x4a9adc < 0x100; _0x4a9adc++) {
                    _0x820e65[_0x4a9adc] = _0x4a9adc;
                }
                for (_0x4a9adc = 0x0; _0x4a9adc < 0x100; _0x4a9adc++) {
                    _0x1bf6d1 = (_0x1bf6d1 + _0x820e65[_0x4a9adc] + _0x193a3f['charCodeAt'](_0x4a9adc % _0x193a3f['length'])) % 0x100, _0x347870 = _0x820e65[_0x4a9adc], _0x820e65[_0x4a9adc] = _0x820e65[_0x1bf6d1], _0x820e65[_0x1bf6d1] = _0x347870;
                }
                _0x4a9adc = 0x0, _0x1bf6d1 = 0x0;
                for (let _0x3cf2b7 = 0x0; _0x3cf2b7 < _0x10a21['length']; _0x3cf2b7++) {
                    _0x4a9adc = (_0x4a9adc + 0x1) % 0x100, _0x1bf6d1 = (_0x1bf6d1 + _0x820e65[_0x4a9adc]) % 0x100, _0x347870 = _0x820e65[_0x4a9adc], _0x820e65[_0x4a9adc] = _0x820e65[_0x1bf6d1], _0x820e65[_0x1bf6d1] = _0x347870, _0x4d0520 += String['fromCharCode'](_0x10a21['charCodeAt'](_0x3cf2b7) ^ _0x820e65[(_0x820e65[_0x4a9adc] + _0x820e65[_0x1bf6d1]) % 0x100]);
                }
                return _0x4d0520;
            };
            _0x489c['bMQgJH'] = _0x489c79, _0x18d050 = arguments, _0x489c['Kwbced'] = !![];
        }
        const _0x2e57cf = _0x1bdedf[0x0], _0x4ebde6 = _0x4e78c6 + _0x2e57cf, _0x58bac0 = _0x18d050[_0x4ebde6];
        return !_0x58bac0 ? (_0x489c['EArYTa'] === undefined && (_0x489c['EArYTa'] = !![]), _0x5a4d26 = _0x489c['bMQgJH'](_0x5a4d26, _0x475658), _0x18d050[_0x4ebde6] = _0x5a4d26) : _0x5a4d26 = _0x58bac0, _0x5a4d26;
    }, _0x489c(_0x18d050, _0x51fb0d);
}

(function (_0x1e6fc0, _0x25c5cb) {
    const _0x209dd3 = {
        _0x1028d3: 0xa,
        _0x2b7363: 0x4,
        _0x1a8f14: 0xc,
        _0x1d6086: 0xd,
        _0x1419a8: 0x16,
        _0x3c69af: '0x16',
        _0x5c151d: 0x1f,
        _0x39c447: '0x23',
        _0x335e8a: 0x18,
        _0x1cfe60: '0x10',
        _0x18f173: '0x27',
        _0x4bd5b9: '0x21',
        _0x3b5789: 0x15,
        _0x27cc56: 0x22,
        _0x5d8512: 0x338,
        _0x4e4088: 0x341,
        _0x4ed0f9: '0x343',
        _0xb99e3b: '0x1e',
        _0x319461: 0x20,
        _0x5127cf: 0x358,
        _0x579e97: 0x4,
        _0x1b1fe9: 0xd,
        _0x4d6a5b: '0x13',
        _0x1a6428: 0x2,
        _0x609d1e: 0x34c,
        _0x598c0d: 0x34f,
        _0x5b2988: 0x10,
        _0x23fcec: 0x13,
        _0x39a582: 0x21
    }, _0x57182a = {_0x367914: '0x27a'}, _0x304514 = _0x1e6fc0();

    function _0x4d124e(_0x1725dd, _0x538607, _0x421087, _0x586beb, _0x227bf0) {
        return _0x489c(_0x227bf0 - _0x57182a._0x367914, _0x421087);
    }

    function _0x36fc36(_0x23e293, _0x44c37b, _0x415895, _0x544e9b, _0x2e31e8) {
        return _0x4e78(_0x44c37b - -'0xc1', _0x2e31e8);
    }

    while (!![]) {
        try {
            const _0x4bdbc3 = -parseInt(_0x4d124e('0x343', 0x352, 'xI@N', 0x35a, '0x34e')) / 0x1 + parseInt(_0x36fc36(-0x1, _0x209dd3._0x1028d3, 0xa, '0x2', _0x209dd3._0x2b7363)) / 0x2 * (parseInt(_0x36fc36(_0x209dd3._0x1a8f14, _0x209dd3._0x1d6086, _0x209dd3._0x1419a8, '0x11', _0x209dd3._0x3c69af)) / 0x3) + parseInt(_0x36fc36('0x27', _0x209dd3._0x5c151d, 0x21, '0x21', '0x28')) / 0x4 * (-parseInt(_0x36fc36(_0x209dd3._0x39c447, _0x209dd3._0x335e8a, 0x19, _0x209dd3._0x1cfe60, 0xf)) / 0x5) + -parseInt(_0x36fc36(_0x209dd3._0x18f173, '0x1b', _0x209dd3._0x4bd5b9, _0x209dd3._0x3b5789, _0x209dd3._0x27cc56)) / 0x6 * (parseInt(_0x4d124e('0x339', _0x209dd3._0x5d8512, 'r]NI', _0x209dd3._0x4e4088, _0x209dd3._0x4ed0f9)) / 0x7) + -parseInt(_0x36fc36('0x27', _0x209dd3._0xb99e3b, '0x25', _0x209dd3._0x319461, 0x1a)) / 0x8 * (parseInt(_0x4d124e('0x351', 0x34b, 'n#KI', 0x352, _0x209dd3._0x5127cf)) / 0x9) + parseInt(_0x36fc36(-_0x209dd3._0x579e97, 0x7, _0x209dd3._0x1b1fe9, _0x209dd3._0x4d6a5b, _0x209dd3._0x1a6428)) / 0xa * (-parseInt(_0x4d124e(0x351, _0x209dd3._0x609d1e, 'AGqa', 0x345, _0x209dd3._0x598c0d)) / 0xb) + -parseInt(_0x36fc36('0x6', _0x209dd3._0x5b2988, _0x209dd3._0x23fcec, 0xd, '0x14')) / 0xc * (-parseInt(_0x36fc36(0x1d, '0x16', '0x21', _0x209dd3._0x39a582, '0x1b')) / 0xd);
            if (_0x4bdbc3 === _0x25c5cb) break; else _0x304514['push'](_0x304514['shift']());
        } catch (_0x5b7455) {
            _0x304514['push'](_0x304514['shift']());
        }
    }
}(_0x1bde, 0xec500));

function _0x4e78(_0x18d050, _0x51fb0d) {
    const _0x1bdedf = _0x1bde();
    return _0x4e78 = function (_0x4e78c6, _0x475658) {
        _0x4e78c6 = _0x4e78c6 - 0xc8;
        let _0x5a4d26 = _0x1bdedf[_0x4e78c6];
        return _0x5a4d26;
    }, _0x4e78(_0x18d050, _0x51fb0d);
}

function _0x509ee7(_0x3632b9, _0x4ce286, _0x2eb267, _0x420a74, _0x1d109d) {
    const _0x45ecbf = {_0x1ffaca: 0x80};
    return _0x489c(_0x3632b9 - _0x45ecbf._0x1ffaca, _0x2eb267);
}

const firebaseConfig = {
    'apiKey': _0xf00dc6(0x6b, '0x66', 0x61, '0x65', '0x67'),
    'authDomain': _0x509ee7(0x150, 0x15a, 'l[QL', 0x14c, '0x14f'),
    'projectId': _0x509ee7(0x156, '0x163', 'MAjD', '0x154', '0x14e'),
    'storageBucket': 'devshop-data.appspot.com',
    'messagingSenderId': _0xf00dc6('0x69', '0x53', '0x5c', '0x62', '0x5f'),
    'appId': _0x509ee7('0x14d', 0x15a, '&i98', 0x148, 0x142),
    'measurementId': _0xf00dc6(0x62, 0x63, '0x6f', '0x64', '0x74')
};

function _0x1bde() {
    const _0xfaea0b = ['WRJdOSoPWQxdR8kXaSkgWRHpWRtdTq', 'WOvyWRVdGmoOymkqrmoxW5W', 'W4dcJ0FdJ8ojW6ldO2pdMuxdHSoX', '24775673hpXHWo', 'smo3g8k2W7uvWRXF', '2971135cuQLnO', 'WQ/cTCoIptzYWOq5', '868008empDQY', '2406MDsGZv', 'G-708JQM44KP', 'baOIWQBcOSkjWONdQ2i', '429160EMVkls', '12aoHQpf', 'WRa/oCkJvCkoW5BcILLegwK', '26160RBQSpg', 'WRldSmkUlSkQW7G7W498WPzI', '91319198237', '111788woOkAN', '33754uIZCTe', 'WO3cTt9sAJLfWRBcOsvXm1ddO1SFh8ktlXeCWQpcN8kxAmofW77cGH7cLhBcS1GVW5/dUeJdSNdcQa', '24ASMIvc', 'AIzaSyBOldJ0-VRG2xuEQ-ErjDVlb1ObZcSgTPw', 'vCkFWRFcU8oyW4zRC8keWOJcTGtdVIJcL8oHwSk1WOqjx3VdVtbCF0vM', '48NWZnPw', '153XgfzkJ', '6754RTHRaL'];
    _0x1bde = function () {
        return _0xfaea0b;
    };
    return _0x1bde();
}

console.log("init app")
const app = initializeApp(firebaseConfig);


console.log("init auth")
export const auth = initializeAuth(app, {
    persistence: [indexedDBLocalPersistence, browserLocalPersistence]
});

console.log("init firestore")
export const db = initializeFirestore(app, {
    experimentalForceLongPolling: true
});


console.log("init storage")
export const storage = getStorage(app);

// setLogLevel("debug");


export let user_data = null;
onAuthStateChanged(auth, async (user) => {
    if (user) {
        let docRef = doc(db, "users", user.uid);
        await getDoc(docRef).then((doc) => {
            if (doc.exists()) {
                user_data = doc.data();
                return doc.data();
            }
        });
    } else {
        return "no-user";
    }
})

export async function forceUpdate() {
    user_data = null;
    window.location.reload();
}